


<% if(addresses && addresses.length> 0){ %>
    <div class="container">
    <% addresses.forEach((address,index)=>{ %>
        <div class="row my-3 border">

            <div class="col-1 my-2">
                <input type="radio" name="addressId" value="<%= address._id %>" %>>
            </div>
            <div class="col-11 my-2">
                <div class="row my-2"><%= address.addressType %></div>
                <div class="row my-2"><%= address.name %></div>
                <div class="row my-2">
                    <div><%= address.landMark %>, <%= address.city %>, <%= address.state %> - <%= address.pincode %></div>
                    <div>
                        Phone: +91 <%= address.phone %>
                        <% if(address.altPhone){ %> 
                            | Alt: +91 <%= address.altPhone %>
                        <% } %>
                    </div>
                </div>
                <div class="row">
                    <button id="editFormBtn<%= index %>" type="button" onclick="showEditAddressForm('<%= index %>')">
                        Edit
                    </button>
                </div>
            </div>  
        </div>

        <div class="row my-3">
            <div class="address-form-container" id="editAddressFormContainer<%= index %>" style="display: none;">
                <form action="" id="editAddressForm<%= index %>">
                    <!-- hidden input for address id -->
                     <input type="hidden" name="addressId" id="addressId" value="<%= address._id %>">

                     <div class="container">
                            <div class="row my-2">

                                <div class="col-4 ">
                                    <label for="addressType">Address Type</label>
                                    <input type="text" class="form-control" id="addressType" name="addressType"
                                        value="<%= address.addressType %>" required>
                                    <div id="addressType-error<%= index %>" class="error-message"></div>
                                </div>

                                <div class="col-4 ">
                                    <label for="name">Name</label>
                                    <input type="text" class="form-control" id="name" name="name" value="<%= address.name %>" required>
                                    <div id="addressName-error<%= index %>" class="error-message"></div>
                                </div>

                                <div class="col-4 ">
                                    <label for="city">City</label>
                                    <input type="text" class="form-control" id="city" name="city" value="<%= address.city %>" required>
                                    <div id="addressCity-error<%= index %>" class="error-message"></div>
                                </div>

                            </div>

                            <div class="row my-2">

                                <div class="col-4 ">
                                    <label for="landMark">Landmark</label>
                                    <input type="text" class="form-control" id="landMark" name="landMark" value="<%= address.landMark%>" required>
                                    <div id="addressLandmark-error<%= index %>" class="error-message"></div>
                                </div>

                                <div class="col-4 ">
                                    <label for="state">State</label>
                                    <input type="text" class="form-control" id="state" name="state" value="<%= address.state %>" required>
                                    <div id="addressState-error<%= index %>" class="error-message"></div>
                                </div>

                                <div class="col-4 ">
                                    <label for="pincode">Pincode</label>
                                    <input type="tel" class="form-control" id="pincode" name="pincode" value="<%= address.pincode %>" required>
                                    <div id="addressPincode-error<%= index %>" class="error-message"></div>
                                </div>

                            </div>

                            <div class="row my-2">

                                <div class="col-4">
                                    <label for="phone">Phone</label>
                                    <input type="tel" class="form-control" id="phone" name="phone" value="<%= address.phone %>" required>
                                    <div id="addressPhone-error<%= index %>" class="error-message"></div>
                                </div>

                                <div class="col-4">
                                    <label for="altPhone">Alternate Phone</label>
                                    <input type="tel" class="form-control" id="altPhone" name="altPhone" value="<%= address.altPhone %>" required>
                                    <div id="addressAltPhone-error<%= index %>" class="error-message"></div>
                                </div>

                                <div class="col-4 ">
                                    
                                </div>

                            </div>

                            <div class="row my-2">

                                <div class="d-flex justify-content-center">
                                    <button type="submit" class="btn btn-primary">Update Address</button>
                                    <button type="button" onclick="showEditAddressForm('<%= index %>')">Cancel</button>
                                </div>

                            </div>
                        </div>
                </form>
            </div>
        </div>
    <% }) %>
    </div>

    <div class="container">
        <div class="row my-3">
            <button onclick="showAddAddressForm()">Add New Address</button>
        </div>
        <div class="row">
            <div class="col">
                <div id="addNewAddressFormContainer" style="display: none;">
                    <form id="addAddressForm">

                        <!-- hidden input for user id -->
                        <input type="hidden" name="userId" value="<%= user._id %>">

                        <div class="container">
                            <div class="row my-2">

                                <div class="col-4 ">
                                    <label for="addressType">Address Type</label>
                                    <input type="text" class="form-control" id="addressType" name="addressType"
                                        required>
                                    <div id="addressType-error" class="error-message"></div>
                                </div>

                                <div class="col-4 ">
                                    <label for="name">Name</label>
                                    <input type="text" class="form-control" id="name" name="name" required>
                                    <div id="addressName-error" class="error-message"></div>
                                </div>

                                <div class="col-4 ">
                                    <label for="city">City</label>
                                    <input type="text" class="form-control" id="city" name="city" required>
                                    <div id="addressCity-error" class="error-message"></div>
                                </div>

                            </div>

                            <div class="row my-2">

                                <div class="col-4 ">
                                    <label for="landMark">Landmark</label>
                                    <input type="text" class="form-control" id="landMark" name="landMark" required>
                                    <div id="addressLandmark-error" class="error-message"></div>
                                </div>

                                <div class="col-4 ">
                                    <label for="state">State</label>
                                    <input type="text" class="form-control" id="state" name="state" required>
                                    <div id="addressState-error" class="error-message"></div>
                                </div>

                                <div class="col-4 ">
                                    <label for="pincode">Pincode</label>
                                    <input type="tel" class="form-control" id="pincode" name="pincode" required>
                                    <div id="addressPincode-error" class="error-message"></div>
                                </div>

                            </div>

                            <div class="row my-2">

                                <div class="col-4">
                                    <label for="phone">Phone</label>
                                    <input type="tel" class="form-control" id="phone" name="phone" required>
                                    <div id="addressPhone-error" class="error-message"></div>
                                </div>

                                <div class="col-4">
                                    <label for="altPhone">Alternate Phone</label>
                                    <input type="tel" class="form-control" id="altPhone" name="altPhone" required>
                                    <div id="addressAltPhone-error" class="error-message"></div>
                                </div>

                                <div class="col-4 ">
                                    
                                </div>

                            </div>

                            <div class="row my-2">

                                <div class="d-flex justify-content-center">
                                    <button type="submit" class="btn btn-primary">Save Address</button>
                                    <button type="button" onclick="hideAddAddressForm()">Cancel</button>
                                </div>

                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
<%} else {%>

    <!--form - add new address -->
    <div>No saved addressess. Please add a delivery address.</div>
    <div class="container">
        <div class="row">
            <div class="col">
                <div id="addNewAddressFormContainer">
                    <form id="addAddressForm">

                        <!-- hidden input for user id -->
                        <input type="hidden" name="userId" value="<%= user._id %>">

                        <div class="container">
                            <div class="row my-2">

                                <div class="col-4 ">
                                    <label for="addressType">Address Type</label>
                                    <input type="text" class="form-control" id="addressType" name="addressType"
                                        required>
                                    <div id="addressType-error" class="error-message"></div>
                                </div>

                                <div class="col-4 ">
                                    <label for="name">Name</label>
                                    <input type="text" class="form-control" id="name" name="name" required>
                                    <div id="addressName-error" class="error-message"></div>
                                </div>

                                <div class="col-4 ">
                                    <label for="city">City</label>
                                    <input type="text" class="form-control" id="city" name="city" required>
                                    <div id="addressCity-error" class="error-message"></div>
                                </div>

                            </div>

                            <div class="row my-2">

                                <div class="col-4 ">
                                    <label for="landMark">Landmark</label>
                                    <input type="text" class="form-control" id="landMark" name="landMark" required>
                                    <div id="addressLandmark-error" class="error-message"></div>
                                </div>

                                <div class="col-4 ">
                                    <label for="state">State</label>
                                    <input type="text" class="form-control" id="state" name="state" required>
                                    <div id="addressState-error" class="error-message"></div>
                                </div>

                                <div class="col-4 ">
                                    <label for="pincode">Pincode</label>
                                    <input type="tel" class="form-control" id="pincode" name="pincode" required>
                                    <div id="addressPincode-error" class="error-message"></div>
                                </div>

                            </div>

                            <div class="row my-2">

                                <div class="col-4">
                                    <label for="phone">Phone</label>
                                    <input type="tel" class="form-control" id="phone" name="phone" required>
                                    <div id="addressPhone-error" class="error-message"></div>
                                </div>

                                <div class="col-4">
                                    <label for="altPhone">Alternate Phone</label>
                                    <input type="tel" class="form-control" id="altPhone" name="altPhone" required>
                                    <div id="addressAltPhone-error" class="error-message"></div>
                                </div>

                                <div class="col-4 ">
                                    
                                </div>

                            </div>

                            <div class="row my-2">

                                <div class="d-flex justify-content-center">
                                    <button type="submit" class="btn btn-primary">Save Address</button>
                                </div>

                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

<% } %>