<style>
  /* Container */
.reset-container {
  max-width: 400px;
  margin: 80px auto;
  padding: 25px;
  background: #ffffff;
  border-radius: 12px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.1);
  text-align: center;
  font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
}

/* Heading */
.reset-container h1 {
  font-size: 1.8rem;
  margin-bottom: 20px;
  color: #333;
}

/* Form group */
.form-group {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  margin-bottom: 20px;
  width: 100%;
}

/* Label */
.form-group label {
  margin-bottom: 8px;
  font-weight: 500;
  color: #555;
}

/* Input */
.form-group input {
  width: 100%;
  padding: 10px 12px;
  border: 1px solid #ccc;
  border-radius: 8px;
  font-size: 1rem;
  transition: border-color 0.3s;
}

.form-group input:focus {
  outline: none;
  border-color: #3085d6;
  box-shadow: 0 0 5px rgba(48,133,214,0.4);
}

/* Error message */
.form-group small {
  color: #d33;
  font-size: 0.85rem;
  margin-top: 5px;
  display: none;
}

/* Button */
.btn {
  width: 100%;
  padding: 12px;
  background: #3085d6;
  color: white;
  font-size: 1rem;
  font-weight: 500;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: background 0.3s;
}

.btn:hover {
  background: #2674c2;
}

/* Spinner inside button */
.btn .spinner {
  border: 2px solid #f3f3f3;
  border-top: 2px solid #fff;
  border-radius: 50%;
  width: 16px;
  height: 16px;
  animation: spin 0.8s linear infinite;
  display: inline-block;
  vertical-align: middle;
  margin-right: 8px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

</style>

<div class="reset-container">
  <h1>Reset Your Password</h1>
  <form id="emailForm" class="form-box">
    <div class="form-group">
      <label for="email">Enter your Email</label>
      <input type="email" name="email" id="email" placeholder="Enter your email" required>
      <small id="email-error"></small>
    </div>
    <button type="submit" class="btn" id="verifyBtn">Verify Email</button>
  </form>
</div>


<script>
  const verifyBtn = document.getElementById('verifyBtn');

  document.getElementById('emailForm').addEventListener('submit', async (e) => {
    e.preventDefault();

    if (validateLoginForm()) {
      const email = document.getElementById('email').value;

      // Add spinner & disable button
      verifyBtn.disabled = true;
      verifyBtn.innerHTML = '<span class="spinner"></span> Verifying...';

      try {
        const response = await fetch('/forgot-password/verify-email', {
          method: "POST",
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ email })
        });

        const result = await response.json();

        if (response.ok) {
          if (result.success) {
            Swal.fire({
              title: "Email verified",
              icon: "success",
              showConfirmButton: true,
              timer: 1000
            }).then(() => {
              window.location.href = result.redirectUrl;
            });
          } else {
            Swal.fire("Oops", result.message, "warning");
          }
        } else {
          Swal.fire("Failed", result.message, "error");
        }
      } catch (err) {
        Swal.fire("Error", "Something went wrong", "error");
      } finally {
        // Restore button
        verifyBtn.disabled = false;
        verifyBtn.innerHTML = 'Verify Email';
      }
    }
  });

  function validateLoginForm() {
    const emailInput = document.getElementById('email');
    const emailError = document.getElementById('email-error');
    const emailValue = emailInput.value.trim();
    const emailPattern = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;

    if (emailValue === '') {
      emailError.textContent = 'Please enter your email.';
      return false;
    } else if (!emailValue.match(emailPattern)) {
      emailError.textContent = 'Please enter a valid email address.';
      return false;
    } else {
      emailError.textContent = '';
      return true;
    }
  }
</script>
<%- include("../../views/partials/user/footer") %>







